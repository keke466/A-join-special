
A Joint Spectral Perspective: Average-Case Analysis with Anisotropic Initialization

This repository contains the code and data for the paper:  
Average-Case Analysis with Anisotropic Initialization: A Joint Spectral Perspective**  
by Guohui Zhang (Daqing Normal University, China).

The paper extends classical average-case analysis of first-order optimization methods to anisotropic initialization. Under a commutativity assumption between the Hessian and the initial covariance, we derive exact finite-dimensional expressions and high-dimensional limits in terms of their joint spectral distribution. Numerical experiments with gradient descent and Nesterov's accelerated method validate the theoretical predictions, showing that alignment between the eigenbases significantly affects convergence speed.

Repository Structure

```
.
├── README.md                               # This file
├── plot_gd_nesterov.py                      # Main script for Experiment 1 (four initialization types, d=50)
├── exp1_with_seed.py                        # Script to run Experiment 1 with a specified random seed
├── run_multiple_seeds.py                     # Batch runner for exp1_with_seed.py (used for robustness analysis)
├── collect_results.py                        # Collects and summarizes results from multiple seeds
├── requirements.txt                          # Python dependencies
├── gd_nesterov_convergence_vertical.pdf      # Figure 1 (generated by plot_gd_nesterov.py)
├── four_cases_stats_seed_42.csv              # Results for seed 42 (Nesterov only)
├── four_cases_stats_seed_100.csv             # Results for seed 100
├── four_cases_stats_seed_2024.csv            # Results for seed 2024
├── four_cases_stats_seed_5678.csv            # Results for seed 5678
├── four_cases_stats_seed_9999.csv            # Results for seed 9999
├── sensitivity_analysis_detailed.csv         # Combined detailed results from all seeds
└── sensitivity_analysis_nesterov.csv         # Pivot table of median iterations for Nesterov (used for Figure 2)
```

Requirements

- Python 3.8 or higher
- Required packages: `numpy`, `scipy`, `pandas`, `matplotlib`

Install dependencies with:
```bash
pip install -r requirements.txt
```

If `requirements.txt` is not present, create it with the following content:
```
numpy
scipy
pandas
matplotlib
```

Reproducing the Experiments

Experiment 1: Four Initialization Types (High-Dimensional, d=50)

Run the main script:
```bash
python plot_gd_nesterov.py
```
This will:
- Perform 50 random initializations for each of the four cases (isotropic, independent, aligned, misaligned)
- Save raw data to `four_cases_raw.csv`
- Save summary statistics to `four_cases_stats.csv`
- Generate **Figure 1** as `gd_nesterov_convergence_vertical.pdf` (convergence curves for GD and Nesterov)

Robustness Analysis Across Different Problem Instances

To test the stability of the results under different Hessian spectra, we repeat Experiment 1 using five different random seeds (42, 100, 2024, 5678, 9999). Each seed produces a different Hessian (with eigenvalues drawn from the same Beta distribution but different realizations).

1. Run the batch script:
   ```bash
   python run_multiple_seeds.py
   ```
   This executes `exp1_with_seed.py` for each seed and generates CSV files like `four_cases_stats_seed_42.csv` etc.

2. Collect and summarize the results:
   ```bash
   python collect_results.py
   ```
   This creates two files:
   - `sensitivity_analysis_detailed.csv`: all records (seed, case, median, CI, success rate)
   - `sensitivity_analysis_nesterov.csv`: a pivot table of Nesterov median iterations per seed (used for **Figure 2**)

Generating Figure 2 (Robustness Bar Chart)

Figure 2 can be plotted from the aggregated data. If you have a plotting script (e.g., `plot_figure2.py`), run it. Otherwise, you can use the following minimal code (based on the data in `sensitivity_analysis_nesterov.csv`):

```python
import pandas as pd
import matplotlib.pyplot as plt
import numpy as np

df = pd.read_csv('sensitivity_analysis_nesterov.csv', index_col=0)
cases = ['aligned', 'independent', 'isotropic', 'misaligned']
colors = ['green', 'blue', 'gray', 'red']
x = np.arange(len(df.index))
width = 0.2

fig, ax = plt.subplots(figsize=(8,5))
for i, case in enumerate(cases):
    ax.bar(x + i*width, df[case].values, width, label=case.capitalize(),
           color=colors[i], edgecolor='black', linewidth=0.8)

ax.set_xlabel('Random seed')
ax.set_ylabel('Median iterations')
ax.set_title('Nesterov: Robustness across problem instances')
ax.set_xticks(x + width*1.5)
ax.set_xticklabels(df.index)
ax.legend()
ax.grid(axis='y', linestyle=':', alpha=0.6)
plt.tight_layout()
plt.savefig('figure2_robustness.pdf')
```

Data Files Description

- `four_cases_stats_seed_*.csv`: Summary for each seed (GD and Nesterov) including success rate, median, and 95% confidence intervals.
- `sensitivity_analysis_detailed.csv`: All records combined.
- `sensitivity_analysis_nesterov.csv`: Pivot table with median iterations for Nesterov only.

Compiling the Paper

The LaTeX source for the paper is not included in this repository (available upon request or from the author). To compile the paper, you need:
- A LaTeX distribution (TeX Live, MiKTeX)
- The `svjour3` document class (Springer’s journal style)
- The two PDF figures (`gd_nesterov_convergence_vertical.pdf` and `figure2_robustness.pdf`) placed in the same directory as the main `.tex` file.

Run:
```bash
pdflatex paper.tex
bibtex paper
pdflatex paper.tex
pdflatex paper.tex
```

Citation

If you use this code or find the paper useful, please cite:

```bibtex
@article{Zhang2026Joint,
  title={Average-Case Analysis with Anisotropic Initialization: A Joint Spectral Perspective},
  author={Zhang, Guohui},
  journal={Optimization Letters},
  year={2026},
  note={To appear}
}
```

License

The code in this repository is released under the MIT License. See the [LICENSE](LICENSE) file for details.

Contact

For questions or comments, please contact Guohui Zhang at dqzgh@163.com.



*Last updated: February 2026*



